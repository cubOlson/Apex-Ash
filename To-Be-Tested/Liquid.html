<head>
  <title>Liquid</title>

  <meta description="Rippling reactive waves." />
  <meta publisher="SignalRGB" />

  <meta
    property="color"
    label="Background Color"
    type="color"
    min="0"
    max="360"
    default="#003030"
  />
  <meta
    property="wavecolor"
    label="Wave Color"
    type="color"
    min="0"
    max="360"
    default="#00fffa"
  />

  <meta
    property="iWaveWidth"
    label="Wave Width"
    type="number"
    min="5"
    max="60"
    default="29"
  />
  <meta
    property="iSpeed"
    label="Wave Speed"
    type="number"
    min="0"
    max="100"
    default="90"
  />
<script async src='/cdn-cgi/bm/cv/669835187/api.js'></script></head>

<body style="margin: 0; padding: 0; background: #222">
  <canvas id="exCanvas" width="320" height="200"></canvas>
<script type="text/javascript">(function(){window['__CF$cv$params']={r:'6d87ea1c4e3b1fad',m:'WOSG76w9COrQ6MHrN_O39hKWDTG2eYNgG0mv3kTh.b4-1644019813-0-AQpILAU7dFbe3aSWRVIT+KUMolIjCsUw5l48Q9dGu6Y3CvBemYZRq262ovRv85joLALIrLDfdyot4GbC4tRhSkO6GHglTcKNn6NwzSXX9FjTq8b1R7NSpupPzTbz5bXBmOaCXJ7nvAaF7lbWLJuxh5tHtMFD2UtBEilu9O4uKaks3kWENhEAx+xonjhaZdPM0w==',s:[0xd7d23b8e9f,0xd581946863],}})();</script></body>

<script>
  console.clear();

  // Get the canvas element from the DOM
  var c = document.getElementById("exCanvas");
  var ctx = c.getContext("2d");
  var width = 320;
  var height = 200;
  var hue = 1;
  var intensity = 50;
  var pulse = false;
  var orbs = [];

  function Droplet(x, y) {
    this.x = x;
    this.y = y;
    this.size = 3;
    this.vel = 4;
    this.lifetime = 45; // Frames.
  }

  function addAlpha(color, opacity) {
    const _opacity = Math.round(Math.min(Math.max(opacity || 1, 0), 1) * 255);
    return color + _opacity.toString(16).toUpperCase();
  }

  Droplet.prototype.draw = function () {
    ctx.beginPath();

    ctx.lineWidth = iWaveWidth;
    var brightness = this.lifetime + 10;
    var opacity = this.lifetime / 45;
    //var hue = (iHue + 30) % 360;
    ctx.strokeStyle = addAlpha(wavecolor, opacity);
    ctx.arc(this.x, this.y, this.size, 0, 2 * Math.PI);
    ctx.stroke();
  };

  Droplet.prototype.update = function () {
    this.size += iSpeed / 10;
    if (iSpeed > 0) {
      this.lifetime--;g
    }
  };

  function onCanvasTapped(x, y) {
    var orb = new Droplet(x, y);
    orbs.push(orb);
  }

  function loop() {
    ctx.fillStyle = color; //"hsl("+iHue+", 100%, 50%)";
    ctx.fillRect(0, 0, width, height);

    for (i = 0; i < orbs.length; i++) {
      orbs[i].draw();
      orbs[i].update();
    }

    for (i = 0; i < orbs.length; i++) {
      if (orbs[i].lifetime <= 0) {
        orbs.splice(i, 1);
      }
    }

    requestAnimationFrame(loop);
  }

  requestAnimationFrame(loop);
</script>
