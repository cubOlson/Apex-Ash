<head>
    <Title>Forza Horizon 5</Title>
    <meta description="Speed trough mexico with this integration" />
    <meta publisher="Jordy Walraven" />
    <meta meter="SpeedMeter" tags = "forza horizon 5, vlc" type="ocr_numeric" x=".855109375" y=".8688888" width=".090" height=".0951388888888889" confidence="10"/>
    <meta meter="FastTravelMeter" tags="vlc, forza horizon 5" type="ocr_textmatch" x=".835546875 " y=".882638888" width=".08789" height=".035" string="FAST TRAVELING" confidence="70" />
    <meta meter="GoMeter" tags="vlc, forza horizon 5" type="ocr_textmatch" x=".42417 " y=".255" width=".139" height=".23958" string="GO" confidence="70" />
    <meta meter="Finish1" tags="vlc,forza horizon 5" type="linear" x=".581" y=".63888" width=".07812" h="310-350" s="60-100" l="70-100"> </meta>
    <meta meter="Wheelspin" tags="vlc,forza horizon 5" type="linear" x=".79" y=".153" width=".105" h="320-350" s="60-100" l="30-90"> </meta>
    <meta meter="Wheelspin2" tags="vlc,forza horizon 5" type="linear" x=".2" y=".153" width=".105" h="320-350" s="60-100" l="30-90"></meta>
    <meta property="HighSpeedColor" label="High speed effect color" type="color" default="#fcba03" min="0" max="360" />
    <meta property="Brightness" label="Screen ambiance brightness" type="number" default="100" min="0" max="100">
    <meta property="SpeedInMiles" label="Speed in miles" type="boolean" default="1" />
    <meta property="EnableSpeed" label="Enable speed effects" type="boolean" default="1" />
    <meta property="EnableFastTravel" label="Enable fast travel effect" type="boolean" default="1" />
    <meta property="EnableGoEffect" label="Enable Go effect" type="boolean" default="0" />
    <meta property="EnableFinishEffect" label="Enable finish effect" type="boolean" default="1" />
    <meta property="EnableWheelspinEffect" label="Enable wheelspin effects" type="boolean" default="1" />

</head>

<body style="margin: 0; padding: 0;">
    <canvas id="exCanvas" width="320" height="200"></canvas>
</body>

<script>
    // Get the canvas element from the DOM
    var c = document.getElementById("exCanvas");
    var ctx = c.getContext("2d");

    var width = 320;
    var height = 200;
    var hue = 0;
    var did = false;

    var effects = []



    var stateHdlr = new StateHandler();

    function StateHandler() {
        var stack = [];
        var state = null;

        // Set current state to the top item in the stack
        var updateState = function () {
            if (stack.length > 0) {
                state = stack[stack.length - 1];
            } else {
                state = null;
            }
        }
        // Allows dev to add effect to state handler
        this.Push = function (newState) {
            stack.push(newState);
            updateState();
        };
        // Allows dev to remove effect from handler
        this.Pop = function () {
            stack.pop();
            updateState();
        };
        // Call the Process function of the current state (effect)
        this.Process = function () {
            if (state != null) {
                state.Process();
            }
        };
    }

    
  function chamberUltSights(){
    this.radius = 0;
    this.Process = function () {
      if (!did) {
        stateMgr.Pop();
      }
        this.Draw();
      };
    this.Draw = function(){
      ctx.fillStyle = "black";
      ctx.fillRect(0, 0, 320, 200);

      ctx.fillStyle = "red";
      ctx.strokeStyle = "yellow";
      ctx.beginPath();
      ctx.arc(160, 100, 10, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(160, 100, this.radius + 50, 0, Math.PI * 2);
      ctx.arc(160, 100, this.radius, 0, Math.PI * 2);
      ctx.lineWidth = 20;
      ctx.stroke();
      this.radius += 2;
      if (this.radius > 200){
        this.radius = 0;
      }
    }
  }


    function update() {


        if (!did){
            stateHdlr.Push(new chamberUltSights());
            did = true;
        }

        for (let i = 0; i < effects.length; i++) {
            effects[i].draw();
            if (effects[i].lifetime <= 0) {
                effects.splice(i, 1);
            }
        }


        stateHdlr.Process();
        window.requestAnimationFrame(update);
    }

    window.requestAnimationFrame(update);
</script>