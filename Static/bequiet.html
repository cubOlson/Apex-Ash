<head>
    <title>Be Quiet!</title>
    <meta description="SignalRGB partnered with be quiet! to bring you this custom free effect." />
    <meta publisher="SignalRGB" />

    <meta
    property="CustomColors"
    label="Custom Colors"
    type="boolean"
    default="0"
    />
    <meta
    property="backgroundColor"
    label="Background Color"
    type="color"
    min="0"
    max="360"
    default="#000000"
    />
    <meta
    property="bubble1Color"
    label="Bubble Color 1"
    type="color"
    min="0"
    max="360"
    default="#FF0000"
    />
    <meta
    property="bubble2Color"
    label="Bubble Color 2"
    type="color"
    min="0"
    max="360"
    default="#FFFF00"
    />
    <meta
    property="randomMovement"
    label="Random Movement"
    type="boolean"
    default="1"
    />
    <meta property="MoveSpeed" label="Movement Speed" type="number" min="0" max="100" default="70"/>
    <meta property="PulseSpeed" label="Pulse Speed" type="number" min="0" max="100" default="70"/>
    <meta property="Size" label="size" type="number" min="0" max="100" default="40"/>
    <meta property="ParticleCount" label="particle count" type="number" min="0" max="200" default="40"/>

</head>
<body style="margin: 0; padding: 0; background: #000;">
  <canvas id="exCanvas" width="320" height="200"></canvas>
</body>
<script>
  canvas = document.getElementById('exCanvas');
  ctx = canvas.getContext('2d');
  var effects = [];
  var start = Date.now()

  function update(){
    var elapsed = Date.now() - start
    
    if(effects.length < ParticleCount && elapsed > 20){
      effects.push(new ball())
      start = Date.now()
    }
    
    if(MoveSpeed > 0){
      drawRect(0, 0, 320, 200, !CustomColors ? `rgb(15, 15, 15)` : backgroundColor);

      effects.forEach((ele, i) => {
        ele.draw();
        if(ele.lifetime <= 0){
          effects.splice(i, 1);
        }
      });
    }

    window.requestAnimationFrame(update);
  }

  function ball(){
    this.x = Math.random() * 280 + 20;
    this.y = Math.random() * 160 + 20;
    this.radius = Math.random() * Size + 1;
    this.vx;
    this.vy;
    if(randomMovement){
      this.vx = Math.sin(Date.now()) * Math.random() * MoveSpeed / 30;
      this.vy = Math.cos(Date.now()) * Math.random() * MoveSpeed / 30;
    } else {
      this.vx = Math.random() * MoveSpeed / 30;
      this.vy = Math.random() * MoveSpeed / 30;
    }
    this.start = Date.now();
    this.color;
    if(!CustomColors){
      this.color = Date.now() % 2 == 0 ? "white" : "darkorange";
    } else {
      this.color = Date.now() % 2 == 0 ? bubble1Color : bubble2Color;
    }
    this.swap = false;
    this.alpha = 0;
    this.lifetime = 10;
    this.draw = function(){
      var elapsed = Date.now() - this.start;
      ctx.globalAlpha = this.alpha;
      DrawCircle(this.x, this.y, this.radius, this.color)
      ctx.globalAlpha = 1;
      if(elapsed < 10000 / PulseSpeed * 5 + 1){
        this.swap = true;
        this.vx *= 1 + PulseSpeed / 10000
        this.vy *= 1 + PulseSpeed / 10000
        this.alpha >= 1 ? this.alpha = 1: this.alpha += .05;
      } else if(elapsed < 20000 / PulseSpeed * 5 + 1 && this.swap){
        this.swap = false;
        this.vx *= -1 - PulseSpeed / 3000
        this.vy *= -1 - PulseSpeed / 3000
      } else if(elapsed < 20000 / PulseSpeed * 5 + 1){
        this.vx *= 1 + PulseSpeed / 3000
        this.vy *= 1 + PulseSpeed / 3000
        this.alpha <= .05 ? this.alpha = .05: this.alpha -= PulseSpeed / 2000;
      }else if(elapsed > 24000 / PulseSpeed * 5 + 1){
        this.lifetime = 0;
      }
      if(PulseSpeed <= 7){
        this.y > 250 + 1000 / PulseSpeed ? this.lifetime = 0 : this.y < -50 - 1000 / PulseSpeed ? this.lifetime = 0: null;
        this.x > 370 + 1000 / PulseSpeed ? this.lifetime = 0 : this.x < -50 - 1000 / PulseSpeed ? this.lifetime = 0: null;
      }
      if(MoveSpeed > 0){
        this.x += this.vx;
        this.y += this.vy;
      }
    }
  }

    function DrawCircle(x, y, radius, color){
        ctx.beginPath();
        ctx.fillStyle = color;
        ctx.arc(x,y,radius, 0, 2* Math.PI)
        ctx.fill();
    };

    function drawRect(x, y, height, width, color){
      ctx.beginPath();
      ctx.fillStyle = color;
      ctx.fillRect(x, y, height, width);
    }

  window.requestAnimationFrame(update);
</script>
  