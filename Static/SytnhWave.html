<head>
    <title>Sine Wave</title>
    <meta description="Cool wave" />
    <meta publisher="JordyWal" />
    <meta property="WaveHeight" label="Wave height" type="number" default="50" min="0" max="100">
    <meta property="WaveLength" label="Wave length" type="number" default="50" min="0" max="100">
    <meta property="WaveY" label="Wave Y" type="number" default="50" min="0" max="100">
    <meta property="Smoothness" label="Smoothness" type="number" default="50" min="0" max="100">
    <meta property="RainbowSpeed" label="Rainbow Speed" type="number" default="10" min="0" max="100">
    <meta property="AnimationSpeed" label="AnimationSpeed" type="number" default="50" min="0" max="100">
    <meta property="BackgroundColor" label="Background color" type="color" default="#00000" min="0" max="360" />
    <meta property="LineColor" label="Line color" type="color" default="#ffffff" min="0" max="360" />
    <meta property="Rainbow" label="Rainbow mode" type="boolean" default="0" />

</head>

<body style="margin: 0; padding: 0;">
    <canvas id="exCanvas" width="320" height="200"></canvas>
</body>

<script>
    // Get the canvas element from the DOM
    var c = document.getElementById("exCanvas");
    var ctx = c.getContext("2d");

    var width = 320;
    var height = 200;
    var hue = 0;
    let speed = 0;
    let color = 0;


    function hexAToRGBA(h) {
        let r = 0, g = 0, b = 0, a = 1;

        if (h.length == 5) {
            r = "0x" + h[1] + h[1];
            g = "0x" + h[2] + h[2];
            b = "0x" + h[3] + h[3];
            a = "0x" + h[4] + h[4];

        } else if (h.length == 9) {
            r = "0x" + h[1] + h[2];
            g = "0x" + h[3] + h[4];
            b = "0x" + h[5] + h[6];
            a = "0x" + h[7] + h[8];
        }
        a = +(a / 255).toFixed(3);

        return "rgba(" + +r + "," + +g + "," + +b + "," + (Smoothness-40)/100 + ")";
    }
    
    function update() {
        // Code goes here
        ctx.beginPath();
        ctx.fillStyle = `${hexAToRGBA(BackgroundColor)}`
        ctx.fillRect(0,0,c.width,c.height)
        ctx.moveTo(0, c.height /2);
        for (let i = 0; i < c.width; i++) {
            ctx.lineTo(i, c.height/2 + (WaveY -50) + Math.sin(i * (WaveLength/1000) + speed)*(WaveHeight-50)*1.75)
        }
        if(!Rainbow){
            ctx.strokeStyle = `${LineColor}`
        } else {
            color += RainbowSpeed/5;
            ctx.strokeStyle = `hsl(${color},50%,50%)`
        }
        
        ctx.stroke()
        speed += AnimationSpeed /1000;
        
        window.requestAnimationFrame(update);
    }

    window.requestAnimationFrame(update);
</script>