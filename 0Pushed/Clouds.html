<head>
  <title>Clouds</title>
    
  <meta description="Drifting Clouds"/>
  <meta publisher="SignalRGB" />

  <meta property="timeOfDay" label="Time of Day" type="combobox" values="Day,Night,Day to Night" default="Day to Night">
  <meta property="direction" label="Cloud Direction" type="combobox" values="Left to Right,Right to Left,Free Floating" default="Left to Right">
  <meta property="background" label="Background Color" type="color" default="#0057c9" min="0" max="360"/>
  <meta property="cloudColor" label="Cloud Color" type="color" default="#F0F9FF" min="0" max="360"/>
  <meta property="daySpeed" label="Speed of Day" type="number" default="30" min="0" max="100">
  <meta property="speed" label="Cloud Speed" type="number" default="10" min="0" max="100">
  <meta property="size" label="Cloud Size" type="number" default="0" min="0" max="10">

</head>

<body style="margin: 0; padding: 0;">
  <canvas id="exCanvas" width="320" height="200"></canvas>
</body>

<script>
  console.clear();
  var c = document.getElementById("exCanvas");
  var ctx = c.getContext("2d");  
  var width = 320;
  var height = 200;
  var timer = 2000;
  var time = 300;
  var day = true;
  var clouds = [];
  var brightness = 50;
  var brightness2 = 97;
  var speed1 = 0;
function cloud(x1, y1) {
this.duration;
this.x1 = x1;
this.y1 = y1;
this.draw = function() {
  if(timeOfDay == "Day"){
  ctx.strokeStyle = cloudColor;
  ctx.fillStyle = cloudColor;
  }else if(timeOfDay == "Night"){
  ctx.strokeStyle = "#8E9BED";
  ctx.fillStyle = "#8E9BED";
  }else{
  ctx.strokeStyle = 'hsl(' + 204 + ',' +  100 + '%,' + brightness2 + '%)';
  ctx.fillStyle = 'hsl(' + 204 + ',' +  100 + '%,' + brightness2 + '%)';
  }
  ctx.lineWidth = 5;
  ctx.beginPath();
  ctx.fillRect(this.x1+10,this.y1-8,30+size,10+size);
  ctx.fillRect(this.x1,this.y1,50+size,12+size);
  ctx.fill();
  ctx.beginPath();
  ctx.moveTo(160, 100);
  ctx.stroke();
  if(direction == "Right to Left"){
    this.x1-= speed1;
  }else if(direction == "Left to Right"){
    this.x1+= speed1;
  }else if(direction == "Free Floating"){
    this.x1+= speed1;
    if(this.x1 > 200){
      this.y1-= speed1;
    }else if(this.x1 < 50){
      this.y1-= speed1;
    }else{
      this.y1+= speed1;
    }
  }
  if(this.x1 === 320){
    this.x1 =0;
  }
  this.duration--;
};
}

  function update() 
  {
    speed1 = speed/10;
    if (time > 500 || time < -300) {
        day = !day;
      }

      if(timeOfDay == "Day to Night") {
        if (day) {
          time += daySpeed / 8;
          if(brightness <50 && brightness2 < 97){
          brightness++;
          brightness2++;
          }
        } else {
          time -= daySpeed / 8;
          if(brightness >10 && brightness2 >25){
          brightness--;
          brightness2--;
          }
        }
      }
      
    if(timeOfDay == "Day"){
      ctx.fillStyle = background;
    }else if(timeOfDay == "Night"){
      ctx.fillStyle = "#000E6A";
    }else{
      ctx.fillStyle = 'hsl(' + 214 + ',' + 100 + '%,' + brightness + '%)';
    }

    ctx.fillRect(0, 0, 320, 200);
    if(direction == "Left to Right"){
      if(timer % 8 == 0){
      clouds.push(new cloud(Math.random() * -320, Math.random() * 200));
      }
    }else if(direction == "Free Floating"){
      if(timer % 8 == 0){
      clouds.push(new cloud(Math.random() * -320, Math.random() * 300));
      }
    }else{
      if(timer % 8 == 0){
      clouds.push(new cloud(Math.random() * 720, Math.random() * 200));
    }
    }
    timer--;

    for (let i = 0; i < clouds.length; i++) {
      clouds[i].draw();
    }

    for (let i = 0; i < clouds.length; i++) {
      if (clouds[i].duration <= 0) {
        clouds.splice(i, 1);
      }
    }

    window.requestAnimationFrame(update);
  }

  window.requestAnimationFrame(update);

</script>